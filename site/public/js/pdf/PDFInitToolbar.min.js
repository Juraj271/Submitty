PDFAnnotate.default&&(PDFAnnotate=PDFAnnotate.default);var loaded=sessionStorage.getItem("toolbar_loaded");window.onbeforeunload=function(){sessionStorage.removeItem("toolbar_loaded")},function(){let e=!0;const t=(t,o,...n)=>{e&&(t(n),e=!1,setTimeout(function(){e=!0},o))};function o(){window.RENDER_OPTIONS.rotate+=90,localStorage.setItem("rotate",window.RENDER_OPTIONS.rotate),render(window.GENERAL_INFORMATION.gradeable_id,window.GENERAL_INFORMATION.user_id,window.RENDER_OPTIONS.grader_id,window.GENERAL_INFORMATION.file_name)}function n(e,t){let o=!0,n=window.RENDER_OPTIONS.scale;"in"==e?n+=.1:"out"==e?n-=.1:(null!=t?n=t/100:o=!1,$("#zoom_selection").toggle()),n>10||n<.25?alert("Cannot zoom more"):o&&($("a[value='zoomcustom']").text(parseInt(100*RENDER_OPTIONS.scale)+"%"),window.RENDER_OPTIONS.scale=n,localStorage.setItem("scale",window.RENDER_OPTIONS.scale),render(window.GENERAL_INFORMATION.gradeable_id,window.GENERAL_INFORMATION.user_id,window.GENERAL_INFORMATION.grader_id,window.GENERAL_INFORMATION.file_name))}function a(){let e=window.GENERAL_INFORMATION,t=buildCourseUrl(["gradeable",e.gradeable_id,"pdf","annotations"]),o=localStorage.getItem(`${window.RENDER_OPTIONS.documentId}/${GENERAL_INFORMATION.grader_id}/annotations`);$.ajax({type:"POST",url:t,data:{annotation_layer:o,GENERAL_INFORMATION:GENERAL_INFORMATION,csrf_token:csrfToken},success:function(e){"success"==JSON.parse(e).status?($("#save_status").text("Saved"),$("#save_status").css("color","black")):alert(e.message)},error:function(){alert("Something went wrong, please contact a administrator.")}})}loaded||document.getElementById("pdf_annotation_icons").addEventListener("click",function(e){!function(e){let l=$(".tool-selected"),c=$("a[value="+e+"]");if(e!=l.attr("value")){if(!c.hasClass("toolbar-action")){switch($(l[0]).removeClass("tool-selected"),c.addClass("tool-selected"),$(l[0]).attr("value")){case"pen":$("#file_content").css("overflow","auto"),$("#scroll_lock_mode").prop("checked",!1),PDFAnnotate.UI.disablePen();break;case"eraser":PDFAnnotate.UI.disableEraser();break;case"cursor":PDFAnnotate.UI.disableEdit();break;case"text":PDFAnnotate.UI.disableText()}$(".selection_panel").hide()}switch(e){case"pen":currentTool="pen",PDFAnnotate.UI.enablePen();break;case"eraser":currentTool="eraser",PDFAnnotate.UI.enableEraser();break;case"cursor":PDFAnnotate.UI.enableEdit();break;case"clear":!function(){if(confirm("Are you sure you want to clear annotations?")){for(let e=0;e<NUM_PAGES;e++)document.querySelector(`div#pageContainer${e+1} svg.annotationLayer`).innerHTML="";localStorage.removeItem(`${RENDER_OPTIONS.documentId}/annotations`)}}();break;case"save":t(a,500);break;case"zoomin":t(n,500,"in");break;case"zoomout":t(n,500,"out");break;case"zoomcustom":t(n,500,"custom");break;case"rotate":t(o,500);break;case"text":currentTool="text",PDFAnnotate.UI.enableText()}}else switch(e){case"pen":$("#pen_selection").toggle();break;case"text":$("#text_selection").toggle()}}(e.target.getAttribute("value"))}),sessionStorage.setItem("toolbar_loaded",!0)}(),function(){let e;function t(t){e!=t&&(e=t,localStorage.setItem("main_color",t),document.getElementById("color_selector").style.backgroundColor=t)}loaded||(document.getElementById("color_selector").addEventListener("click",function(e){let t=!$("#color_selector_menu").is(":visible");$(".selection-menu").hide(),t&&$("#color_selector_menu").toggle()}),document.getElementById("size_selector").addEventListener("click",function(){let e=!$("#size_selector_menu").is(":visible");$(".selection-menu").hide(),e&&$("#size_selector_menu").toggle()}),document.addEventListener("colorchange",function(e){t(e.srcElement.getAttribute("value"))})),function(){let e=localStorage.getItem("main_color")||"#ff0000";document.getElementById("color_selector").style.backgroundColor=e,t(e)}()}(),function(){let e,t,o;function n(n,a){let l=!1;e!==n&&(l=!0,e=n,localStorage.setItem("pen/size",e)),t!==a&&(l=!0,t=a),l&&o&&$("#file_content").css("overflow","hidden"),l&&PDFAnnotate.UI.setPen(e,t)}document.getElementById("pen_size_selector").addEventListener("change",function(e){n(e.target.value?e.target.value:e.srcElement.value,t)}),document.addEventListener("colorchange",function(t){n(e,t.srcElement.getAttribute("value"))}),function(){let e=localStorage.getItem("pen/size")||3,t=localStorage.getItem("main_color")||"#FF0000";document.getElementById("pen_size_selector").value=e,document.getElementById("pen_size_value").value=e,$("#scroll_lock_mode").is(":checked")&&(o=!0),n(e,t)}()}(),function(){let e,t;function o(o,n){let a=!1;e!==o&&(a=!0,e=o,localStorage.setItem("text/size",e)),t!==n&&(a=!0,t=n),a&&PDFAnnotate.UI.setText(e,t)}loaded||(document.addEventListener("colorchange",function(t){o(e,t.srcElement.getAttribute("value"))}),document.getElementById("text_size_selector").addEventListener("change",function(e){o(e.target.value?e.target.value:e.srcElement.value,t)})),function(){let e=localStorage.getItem("text/size")||12,t=localStorage.getItem("main_color")||"#FF0000";document.getElementById("text_size_selector").value=e,o(e,t)}()}();